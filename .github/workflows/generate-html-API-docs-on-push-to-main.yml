name: Generate API Docs
# This Github Action generates API documents using doxygen using
# the , with flags to generate in the "numpy" style.
# The output are HTML documents saved to "docs"

on:
  push:
    branches: ["gh-action-doxygen"]
    # branches: ["main"]

jobs:
  generate-and-push:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout the repository
        uses: actions/checkout@v3

      - name: Generate API documentation
        uses: mattnotmitt/doxygen-action@v1.9.5
        with:
          working-directory: '.'
          doxyfile-path: './docs/doxygen/Doxyfile-awesome'


      - name: Commit and Push Changes
        run: |
          git config --local user.email "n44412824+anup2ladder@users.noreply.github.com"
          git config --local user.name "kirtonBCIlab"
          git add ./docs
          git add -u ./Packages
          git commit -m "Auto-generated API docs"
          git push origin gh-action-doxygen

      # - name: Commit and Push Changes
      #   run: |
      #     git config --local user.email "n44412824+anup2ladder@users.noreply.github.com"
      #     git config --local user.name "kirtonBCIlab"
      #     git add ./docs
      #     git add -u ./Packages
      #     git commit -m "Auto-generated API docs and removed unnecessary files"
      #     git push origin main

      # - name: Initialize conda environment
      #   uses: conda-incubator/setup-miniconda@v2
      #   with:
      #     environment-file: environment.yml
      #     activate-environment: bci

      # - name: Install dependencies
      #   shell: bash -el {0}
      #   run: |
      #     conda activate bci
      #     conda info
      #     pip install .
      #     pip install pdoc

      # - name: Remove Packages folder
      #   run: |
      #     rm -rf ./Packages
